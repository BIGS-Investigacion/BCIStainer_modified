---


exp:  unet_exp1
seed: 42

loader:
  norm_method: global_minmax
  train_batch: 4
  val_batch:   4
  num_workers: 20
  pin_memory:  True

G:
  name: unet
  params:
    encoder_name:     resnet34
    encoder_depth:    5
    encoder_weights:  null
    decoder_channels: [256, 128, 64, 32, 16]
    in_channels:      3
    classes:          3
    activation:       tanh
    aux_params:
      classes:        4
      pooling:        avg
      dropout:        0.2
      activation:     null
  init:
    init_type:   normal
    init_gain:   0.02

D:
  name: patch_gan
  params:
    input_nc:  6
    ndf:       64
    n_layers:  3
    norm_type: batch
  init:
    init_type: normal
    init_gain: 0.02

loss:
  cls:
    mode:   ce
    weight: 1.0
  rec:
    mode:   mse
    weight: 10.0
  sim:
    mode:   ssim
    weight: 1.0
  gan:
    mode:   lsgan
    weight: 1.0

optimizer:
  name: Adam
  params:
    lr:           0.0003
    betas:        [0.5, 0.999]
    weight_decay: 0.0

scheduler:
  min_lr: 0.00001
  warmup: 0

trainer:
  epochs:     100
  accum_iter: 4
  ckpt_freq:  25
  print_freq: 100


...
